logstashPipeline: 
 logstash.conf: |
   input {
     beats {
       port => 5044
     }
   }

   output {
     elasticsearch {
       hosts => ["http://elasticsearch-master:9200"]

       user => "${ELASTIC_USER}"
       password => "${ELASTIC_PASSWORD}"

       ssl => true
       cacert => "/usr/share/logstash/config/http_ca.crt"
     }
   }


extraEnvs:
  - name: ELASTIC_USER
    valueFrom:
      secretKeyRef:
        name: elasticsearch-master-credentials
        key: username
  - name: ELASTIC_PASSWORD
    valueFrom:
      secretKeyRef:
        name: elasticsearch-master-credentials
        key: password

extraVolumes:
  - name: es-ca
    secret:
      secretName: es-http-ca
extraVolumeMounts:
  - name: es-ca
    mountPath: /usr/share/logstash/config/http_ca.crt
    subPath: http_ca.crt


service:
  annotations: {}
  type: ClusterIP
  loadBalancerIP: ""
  ports:
    - name: beats
      port: 5044
      protocol: TCP
      targetPort: 5044
    - name: http
      port: 8080
      protocol: TCP
      targetPort: 8080
